(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[2023],{2023:(e,a,t)=>{Promise.resolve().then(t.bind(t,27641)),Promise.resolve().then(t.bind(t,24146)),Promise.resolve().then(t.bind(t,76915))},76915:(e,a,t)=>{"use strict";t.d(a,{PackageForm:()=>O});var r=t(95155),s=t(12115),n=t(76046),l=t(69606),i=t(85060),d=t(43415),o=t(14085),c=t(34839),u=t(9955),m=t(10371),p=t(63409),f=t(51719),h=t(91902),x=t(98867),j=t(29602);let g=p.bL;p.YJ;let b=p.WT,v=s.forwardRef((e,a)=>{let{className:t,children:s,...n}=e;return(0,r.jsxs)(p.l9,{ref:a,className:(0,j.cn)("flex h-9 w-full items-center justify-between whitespace-nowrap rounded-md border border-input bg-transparent px-3 py-2 text-sm shadow-sm ring-offset-background data-[placeholder]:text-muted-foreground focus:outline-none focus:ring-1 focus:ring-ring disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1",t),...n,children:[s,(0,r.jsx)(p.In,{asChild:!0,children:(0,r.jsx)(f.A,{className:"h-4 w-4 opacity-50"})})]})});v.displayName=p.l9.displayName;let y=s.forwardRef((e,a)=>{let{className:t,...s}=e;return(0,r.jsx)(p.PP,{ref:a,className:(0,j.cn)("flex cursor-default items-center justify-center py-1",t),...s,children:(0,r.jsx)(h.A,{className:"h-4 w-4"})})});y.displayName=p.PP.displayName;let w=s.forwardRef((e,a)=>{let{className:t,...s}=e;return(0,r.jsx)(p.wn,{ref:a,className:(0,j.cn)("flex cursor-default items-center justify-center py-1",t),...s,children:(0,r.jsx)(f.A,{className:"h-4 w-4"})})});w.displayName=p.wn.displayName;let N=s.forwardRef((e,a)=>{let{className:t,children:s,position:n="popper",...l}=e;return(0,r.jsx)(p.ZL,{children:(0,r.jsxs)(p.UC,{ref:a,className:(0,j.cn)("relative z-50 max-h-96 min-w-[8rem] overflow-hidden rounded-md border bg-popover text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2","popper"===n&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",t),position:n,...l,children:[(0,r.jsx)(y,{}),(0,r.jsx)(p.LM,{className:(0,j.cn)("p-1","popper"===n&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]"),children:s}),(0,r.jsx)(w,{})]})})});N.displayName=p.UC.displayName,s.forwardRef((e,a)=>{let{className:t,...s}=e;return(0,r.jsx)(p.JU,{ref:a,className:(0,j.cn)("px-2 py-1.5 text-sm font-semibold",t),...s})}).displayName=p.JU.displayName;let k=s.forwardRef((e,a)=>{let{className:t,children:s,...n}=e;return(0,r.jsxs)(p.q7,{ref:a,className:(0,j.cn)("relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-2 pr-8 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",t),...n,children:[(0,r.jsx)("span",{className:"absolute right-2 flex h-3.5 w-3.5 items-center justify-center",children:(0,r.jsx)(p.VF,{children:(0,r.jsx)(x.A,{className:"h-4 w-4"})})}),(0,r.jsx)(p.p4,{children:s})]})});k.displayName=p.q7.displayName,s.forwardRef((e,a)=>{let{className:t,...s}=e;return(0,r.jsx)(p.wv,{ref:a,className:(0,j.cn)("-mx-1 my-1 h-px bg-muted",t),...s})}).displayName=p.wv.displayName;var T=t(89134),C=t(35007),A=t(86352);let R=s.forwardRef((e,a)=>{let{className:t,...s}=e;return(0,r.jsx)(A.bL,{ref:a,className:(0,j.cn)("peer h-4 w-4 shrink-0 rounded-sm border border-primary shadow focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground",t),...s,children:(0,r.jsx)(A.C1,{className:(0,j.cn)("flex items-center justify-center text-current"),children:(0,r.jsx)(x.A,{className:"h-4 w-4"})})})});R.displayName=A.bL.displayName;var S=t(38684),I=t(40767),M=t(14505),P=t(5565);let z=d.z.object({name:d.z.string().min(1,"Nama paket wajib diisi"),description:d.z.string().optional(),price:d.z.coerce.number().positive("Harga harus lebih dari 0"),tenorMonths:d.z.coerce.number().int().positive("Tenor harus lebih dari 0"),monthlyAmount:d.z.coerce.number().positive("Cicilan bulanan harus lebih dari 0"),packageTypeId:d.z.string().min(1,"Jenis paket wajib dipilih"),isActive:d.z.boolean().default(!0)});function O(e){var a;let{packageTypes:t,packageData:d}=e,[p,f]=(0,s.useState)(!1),[h,x]=(0,s.useState)(null),[j,y]=(0,s.useState)((null==d?void 0:d.imageUrl)||null),[w,A]=(0,s.useState)(!1),O=(0,s.useRef)(null),F=(0,n.useRouter)(),{toast:J}=(0,T.dj)(),E=(0,l.mN)({resolver:(0,i.u)(z),defaultValues:{name:(null==d?void 0:d.name)||"",description:(null==d?void 0:d.description)||"",price:(null==d?void 0:d.price)||0,tenorMonths:(null==d?void 0:d.tenorMonths)||12,monthlyAmount:(null==d?void 0:d.monthlyAmount)||0,packageTypeId:(null==d?void 0:d.packageTypeId)||"",isActive:null===(a=null==d?void 0:d.isActive)||void 0===a||a}}),D=async e=>{A(!0);try{let a=new FormData;a.append("file",e);let t=await fetch("/api/upload",{method:"POST",body:a});if(!t.ok){let e=await t.json();throw Error(e.message||"Terjadi kesalahan saat mengunggah gambar")}return(await t.json()).fileUrl}catch(e){throw e}finally{A(!1)}},U=async e=>{f(!0);try{let a=(null==d?void 0:d.imageUrl)||null;h&&(a=await D(h));let t=d?"/api/packages/".concat(d.id):"/api/packages",r=d?"PUT":"POST",s=await fetch(t,{method:r,headers:{"Content-Type":"application/json"},body:JSON.stringify({...e,imageUrl:a})});if(!s.ok){let e=await s.json();throw Error(e.message||"Terjadi kesalahan saat menyimpan paket")}J({title:"Berhasil",description:d?"Paket berhasil diperbarui":"Paket berhasil ditambahkan"}),F.push("/admin/packages"),F.refresh()}catch(e){J({variant:"destructive",title:"Gagal",description:e instanceof Error?e.message:"Terjadi kesalahan saat menyimpan paket"})}finally{f(!1)}},_=(e,a)=>{e&&a&&a>0&&E.setValue("monthlyAmount",e/a)};return(0,r.jsx)(C.Zp,{children:(0,r.jsx)(C.Wu,{className:"pt-6",children:(0,r.jsx)(c.lV,{...E,children:(0,r.jsxs)("form",{onSubmit:E.handleSubmit(U),className:"space-y-6",children:[(0,r.jsx)(c.zB,{control:E.control,name:"name",render:e=>{let{field:a}=e;return(0,r.jsxs)(c.eI,{children:[(0,r.jsx)(c.lR,{children:"Nama Paket"}),(0,r.jsx)(c.MJ,{children:(0,r.jsx)(u.p,{placeholder:"Masukkan nama paket",...a})}),(0,r.jsx)(c.C5,{})]})}}),(0,r.jsx)(c.zB,{control:E.control,name:"description",render:e=>{let{field:a}=e;return(0,r.jsxs)(c.eI,{children:[(0,r.jsx)(c.lR,{children:"Deskripsi (Opsional)"}),(0,r.jsx)(c.MJ,{children:(0,r.jsx)(m.T,{placeholder:"Masukkan deskripsi paket",...a,value:a.value||""})}),(0,r.jsx)(c.C5,{})]})}}),(0,r.jsxs)("div",{className:"grid gap-6 md:grid-cols-2",children:[(0,r.jsx)(c.zB,{control:E.control,name:"price",render:e=>{let{field:a}=e;return(0,r.jsxs)(c.eI,{children:[(0,r.jsx)(c.lR,{children:"Harga Total (Rp)"}),(0,r.jsx)(c.MJ,{children:(0,r.jsx)(u.p,{type:"number",placeholder:"Masukkan harga total",...a,onChange:e=>{a.onChange(e),_(Number.parseFloat(e.target.value),E.getValues("tenorMonths"))}})}),(0,r.jsx)(c.C5,{})]})}}),(0,r.jsx)(c.zB,{control:E.control,name:"tenorMonths",render:e=>{let{field:a}=e;return(0,r.jsxs)(c.eI,{children:[(0,r.jsx)(c.lR,{children:"Tenor (Bulan)"}),(0,r.jsx)(c.MJ,{children:(0,r.jsx)(u.p,{type:"number",placeholder:"Masukkan tenor dalam bulan",...a,onChange:e=>{a.onChange(e),_(E.getValues("price"),Number.parseFloat(e.target.value))}})}),(0,r.jsx)(c.C5,{})]})}})]}),(0,r.jsx)(c.zB,{control:E.control,name:"monthlyAmount",render:e=>{let{field:a}=e;return(0,r.jsxs)(c.eI,{children:[(0,r.jsx)(c.lR,{children:"Cicilan per Bulan (Rp)"}),(0,r.jsx)(c.MJ,{children:(0,r.jsx)(u.p,{type:"number",placeholder:"Masukkan cicilan per bulan",...a})}),(0,r.jsx)(c.C5,{})]})}}),(0,r.jsx)(c.zB,{control:E.control,name:"packageTypeId",render:e=>{let{field:a}=e;return(0,r.jsxs)(c.eI,{children:[(0,r.jsx)(c.lR,{children:"Jenis Paket"}),(0,r.jsxs)(g,{onValueChange:a.onChange,defaultValue:a.value,children:[(0,r.jsx)(c.MJ,{children:(0,r.jsx)(v,{children:(0,r.jsx)(b,{placeholder:"Pilih jenis paket"})})}),(0,r.jsx)(N,{children:t.map(e=>(0,r.jsx)(k,{value:e.id,children:e.name},e.id))})]}),(0,r.jsx)(c.C5,{})]})}}),(0,r.jsx)(c.zB,{control:E.control,name:"isActive",render:e=>{let{field:a}=e;return(0,r.jsxs)(c.eI,{className:"flex flex-row items-start space-x-3 space-y-0 rounded-md border p-4",children:[(0,r.jsx)(c.MJ,{children:(0,r.jsx)(R,{checked:a.value,onCheckedChange:a.onChange})}),(0,r.jsxs)("div",{className:"space-y-1 leading-none",children:[(0,r.jsx)(c.lR,{children:"Aktif"}),(0,r.jsx)("p",{className:"text-sm text-muted-foreground",children:"Paket yang aktif akan ditampilkan kepada reseller"})]})]})}}),(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)(c.lR,{children:"Gambar Paket (Opsional)"}),(0,r.jsxs)("div",{className:"flex items-center gap-4",children:[(0,r.jsxs)(o.$,{type:"button",variant:"outline",onClick:()=>{var e;return null===(e=O.current)||void 0===e?void 0:e.click()},children:[(0,r.jsx)(S.A,{className:"mr-2 h-4 w-4"}),"Unggah Gambar"]}),(0,r.jsx)(u.p,{ref:O,type:"file",accept:"image/jpeg, image/png",className:"hidden",onChange:e=>{var a;let t=null===(a=e.target.files)||void 0===a?void 0:a[0];if(!t)return;if(!["image/jpeg","image/png","image/jpg"].includes(t.type)){J({variant:"destructive",title:"Format file tidak didukung",description:"Silakan unggah file dengan format JPG atau PNG"});return}if(t.size>5242880){J({variant:"destructive",title:"Ukuran file terlalu besar",description:"Ukuran file maksimal 5MB"});return}x(t);let r=new FileReader;r.onloadend=()=>{y(r.result)},r.readAsDataURL(t)}}),j&&(0,r.jsxs)(o.$,{type:"button",variant:"destructive",size:"sm",onClick:()=>{x(null),y(null),O.current&&(O.current.value="")},children:[(0,r.jsx)(I.A,{className:"mr-2 h-4 w-4"}),"Hapus Gambar"]})]}),j&&(0,r.jsx)("div",{className:"mt-4 relative aspect-video w-full max-w-md rounded-md overflow-hidden border",children:(0,r.jsx)(P.default,{src:j||"/placeholder.svg",alt:"Preview",fill:!0,className:"object-cover"})})]}),(0,r.jsxs)("div",{className:"flex justify-end gap-4",children:[(0,r.jsx)(o.$,{type:"button",variant:"outline",onClick:()=>F.push("/admin/packages"),children:"Batal"}),(0,r.jsxs)(o.$,{type:"submit",disabled:p||w,children:[(p||w)&&(0,r.jsx)(M.A,{className:"mr-2 h-4 w-4 animate-spin"}),d?"Perbarui":"Simpan"]})]})]})})})})}},34839:(e,a,t)=>{"use strict";t.d(a,{C5:()=>g,MJ:()=>x,Rr:()=>j,eI:()=>f,lR:()=>h,lV:()=>o,zB:()=>u});var r=t(95155),s=t(12115),n=t(12317),l=t(69606),i=t(29602),d=t(15785);let o=l.Op,c=s.createContext({}),u=e=>{let{...a}=e;return(0,r.jsx)(c.Provider,{value:{name:a.name},children:(0,r.jsx)(l.xI,{...a})})},m=()=>{let e=s.useContext(c),a=s.useContext(p),{getFieldState:t,formState:r}=(0,l.xW)(),n=t(e.name,r);if(!e)throw Error("useFormField should be used within <FormField>");let{id:i}=a;return{id:i,name:e.name,formItemId:"".concat(i,"-form-item"),formDescriptionId:"".concat(i,"-form-item-description"),formMessageId:"".concat(i,"-form-item-message"),...n}},p=s.createContext({}),f=s.forwardRef((e,a)=>{let{className:t,...n}=e,l=s.useId();return(0,r.jsx)(p.Provider,{value:{id:l},children:(0,r.jsx)("div",{ref:a,className:(0,i.cn)("space-y-2",t),...n})})});f.displayName="FormItem";let h=s.forwardRef((e,a)=>{let{className:t,...s}=e,{error:n,formItemId:l}=m();return(0,r.jsx)(d.J,{ref:a,className:(0,i.cn)(n&&"text-destructive",t),htmlFor:l,...s})});h.displayName="FormLabel";let x=s.forwardRef((e,a)=>{let{...t}=e,{error:s,formItemId:l,formDescriptionId:i,formMessageId:d}=m();return(0,r.jsx)(n.DX,{ref:a,id:l,"aria-describedby":s?"".concat(i," ").concat(d):"".concat(i),"aria-invalid":!!s,...t})});x.displayName="FormControl";let j=s.forwardRef((e,a)=>{let{className:t,...s}=e,{formDescriptionId:n}=m();return(0,r.jsx)("p",{ref:a,id:n,className:(0,i.cn)("text-[0.8rem] text-muted-foreground",t),...s})});j.displayName="FormDescription";let g=s.forwardRef((e,a)=>{var t;let{className:s,children:n,...l}=e,{error:d,formMessageId:o}=m(),c=d?String(null!==(t=null==d?void 0:d.message)&&void 0!==t?t:""):n;return c?(0,r.jsx)("p",{ref:a,id:o,className:(0,i.cn)("text-[0.8rem] font-medium text-destructive",s),...l,children:c}):null});g.displayName="FormMessage"},9955:(e,a,t)=>{"use strict";t.d(a,{p:()=>l});var r=t(95155),s=t(12115),n=t(29602);let l=s.forwardRef((e,a)=>{let{className:t,type:s,...l}=e;return(0,r.jsx)("input",{type:s,className:(0,n.cn)("flex h-9 w-full rounded-md border border-input bg-transparent px-3 py-1 text-base shadow-sm transition-colors file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",t),ref:a,...l})});l.displayName="Input"},15785:(e,a,t)=>{"use strict";t.d(a,{J:()=>o});var r=t(95155),s=t(12115),n=t(46195),l=t(31027),i=t(29602);let d=(0,l.F)("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),o=s.forwardRef((e,a)=>{let{className:t,...s}=e;return(0,r.jsx)(n.b,{ref:a,className:(0,i.cn)(d(),t),...s})});o.displayName=n.b.displayName},10371:(e,a,t)=>{"use strict";t.d(a,{T:()=>l});var r=t(95155),s=t(12115),n=t(29602);let l=s.forwardRef((e,a)=>{let{className:t,...s}=e;return(0,r.jsx)("textarea",{className:(0,n.cn)("flex min-h-[60px] w-full rounded-md border border-input bg-transparent px-3 py-2 text-base shadow-sm placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",t),ref:a,...s})});l.displayName="Textarea"},89134:(e,a,t)=>{"use strict";t.d(a,{dj:()=>m});var r=t(12115);let s=0,n=new Map,l=e=>{if(n.has(e))return;let a=setTimeout(()=>{n.delete(e),c({type:"REMOVE_TOAST",toastId:e})},1e6);n.set(e,a)},i=(e,a)=>{switch(a.type){case"ADD_TOAST":return{...e,toasts:[a.toast,...e.toasts].slice(0,1)};case"UPDATE_TOAST":return{...e,toasts:e.toasts.map(e=>e.id===a.toast.id?{...e,...a.toast}:e)};case"DISMISS_TOAST":{let{toastId:t}=a;return t?l(t):e.toasts.forEach(e=>{l(e.id)}),{...e,toasts:e.toasts.map(e=>e.id===t||void 0===t?{...e,open:!1}:e)}}case"REMOVE_TOAST":if(void 0===a.toastId)return{...e,toasts:[]};return{...e,toasts:e.toasts.filter(e=>e.id!==a.toastId)}}},d=[],o={toasts:[]};function c(e){o=i(o,e),d.forEach(e=>{e(o)})}function u(e){let{...a}=e,t=(s=(s+1)%Number.MAX_VALUE).toString(),r=()=>c({type:"DISMISS_TOAST",toastId:t});return c({type:"ADD_TOAST",toast:{...a,id:t,open:!0,onOpenChange:e=>{e||r()}}}),{id:t,dismiss:r,update:e=>c({type:"UPDATE_TOAST",toast:{...e,id:t}})}}function m(){let[e,a]=r.useState(o);return r.useEffect(()=>(d.push(a),()=>{let e=d.indexOf(a);e>-1&&d.splice(e,1)}),[e]),{...e,toast:u,dismiss:e=>c({type:"DISMISS_TOAST",toastId:e})}}}}]);